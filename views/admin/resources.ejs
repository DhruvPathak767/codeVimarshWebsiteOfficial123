<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    <%= pageTitle %>
  </title>
  <link rel="stylesheet" href="/output.css">
  <link rel="stylesheet" href="/css/home.css">
  <link rel="stylesheet" href="/css/admin.css">
  <link rel="stylesheet" href="/css/buttons.css">
  <link rel="stylesheet" href="/css/animations.css">
  <link
    href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@300;400;600;800&display=swap"
    rel="stylesheet">
</head>

<body class="antialiased selection:bg-primary selection:text-black">
  <canvas id="bg-canvas"></canvas>

  <div class="relative z-10 flex flex-col min-h-screen">
    <%- include('../partials/nav.ejs') %>

      <main class="flex-grow pt-24 pb-12 px-4 sm:px-6 lg:px-8">
        <div class="max-w-7xl mx-auto">
          <div class="flex justify-between items-center mb-12">
            <h1 class="text-3xl md:text-5xl font-display font-bold">
              Manage <span class="text-gradient">Resources</span>
            </h1>
          </div>

          <!-- Add Resource Form -->
          <div class="glass-effect p-8 rounded-2xl border border-white/10 mb-12">
            <h2 class="text-xl font-bold text-white mb-6">Add New Resource</h2>
            <form action="/admin/resources" method="POST" enctype="multipart/form-data"
              class="grid grid-cols-1 md:grid-cols-2 gap-6">

              <!-- Title -->
              <div class="form-group">
                <input type="text" id="title" name="title" class="form-input" placeholder=" " required>
                <label for="title" class="form-label">Title</label>
              </div>

              <!-- Category -->
              <div class="form-group">
                <!-- Select doesn't behave exactly like text input for placeholder-shown. 
                     We can use a dummy first option, or just keep label static. 
                     Signup.ejs style uses floating labels. For Select, standard is usually fixed label or floating if supported.
                     I'll try floating but 'select' usually needs a value to trigger 'not placeholder shown'.
                -->
                <select id="category" name="category" class="form-input" required>
                  <option value="" disabled selected></option> <!-- Needed for placeholder check -->
                  <option value="dsa">DSA Sheet</option>
                  <option value="playlist">Youtube Playlist</option>
                  <option value="other">Other</option>
                </select>
                <label for="category" class="form-label">Category</label>
              </div>

              <!-- Description -->
              <div class="form-group md:col-span-2">
                <textarea id="description" name="description" class="form-input" rows="3" placeholder=" "
                  required></textarea>
                <label for="description" class="form-label">Description</label>
              </div>

              <!-- Link -->
              <div class="form-group">
                <input type="url" id="link" name="link" class="form-input" placeholder=" " required>
                <label for="link" class="form-label">Resource Link</label>
              </div>

              <!-- Image File -->
              <div class="form-group">
                <input type="file" id="image" name="image" class="form-input" style="padding-top: 1rem; height: auto;"
                  required>
                <!-- For file input, label floating is hard. Let's make it static or top.
                     Signup.ejs didn't have file. I'll modify label to be visible. -->
                <label for="image" class="form-label"
                  style="top: -0.5rem; left: 0.75rem; font-size: 0.75rem; background: #0f172a; padding: 0 0.5rem; color: #08d9d6;">Resource
                  Image</label>
              </div>

              <div class="md:col-span-2">
                <button type="submit"
                  class="btn-cyber px-8 py-3 w-full md:w-auto rounded-sm text-sm font-bold uppercase tracking-wider">
                  Add Resource
                </button>
              </div>
            </form>
          </div>

          <!-- Resources List -->
          <% if (resources.length> 0) { %>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
              <% for (let resItem of resources) { %>
                <div
                  class="glass-effect rounded-2xl overflow-hidden border border-white/5 hover:border-primary/30 transition-all flex flex-col">
                  <div class="relative w-full overflow-hidden bg-gray-900 group-hover:opacity-90 transition-opacity"
                    style="height: 200px;">
                    <img src="<%= resItem.imageUrl %>" alt="<%= resItem.title %>"
                      class="absolute inset-0 w-full h-full object-cover">
                    <div
                      class="absolute top-4 right-4 bg-black/70 backdrop-blur-md px-3 py-1 rounded-full border border-white/10 shadow-xl">
                      <span class="text-xs font-code text-primary uppercase tracking-wider">
                        <%= resItem.category %>
                      </span>
                    </div>
                  </div>
                  <div class="p-6 flex-grow flex flex-col">
                    <h3 class="text-xl font-bold text-white mb-2">
                      <%= resItem.title %>
                    </h3>
                    <p class="text-text-muted text-sm mb-4 line-clamp-3">
                      <%= resItem.description %>
                    </p>

                    <a href="<%= resItem.link %>" target="_blank"
                      class="text-primary hover:text-white text-xs mb-6 truncate block font-code">
                      ðŸ”— Open Resource
                    </a>

                    <div class="flex gap-4 mt-auto pt-6 border-t border-white/5">
                      <a href="/admin/resources/edit/<%= resItem._id %>"
                        class="flex-1 flex items-center justify-center gap-2 py-2.5 rounded-sm text-sm font-bold uppercase tracking-wider border border-primary/50 text-primary bg-primary/10 hover:bg-primary/20 hover:shadow-[0_0_20px_rgba(8,217,214,0.4)] transform hover:scale-105 transition-all duration-300">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                        Edit
                      </a>
                      <form action="/admin/resources/delete" method="POST" class="flex-1">
                        <input type="hidden" name="resourceId" value="<%= resItem._id %>">
                        <button type="submit"
                          class="w-full flex items-center justify-center gap-2 py-2.5 rounded-sm text-sm font-bold uppercase tracking-wider border border-red-500/50 text-red-500 bg-red-500/10 hover:bg-red-500/20 hover:shadow-[0_0_20px_rgba(239,68,68,0.4)] transform hover:scale-105 transition-all duration-300">
                          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                          </svg>
                          Delete
                        </button>
                      </form>
                    </div>
                  </div>
                </div>
                <% } %>
            </div>
            <% } else { %>
              <div class="glass-effect p-12 rounded-2xl text-center border border-white/5">
                <h2 class="text-2xl font-bold text-white mb-2">No Resources Found</h2>
              </div>
              <% } %>
        </div>
      </main>

      <%- include('../partials/footer.ejs') %>
  </div>
  <script src="/js/home.js"></script>
</body>

</html>